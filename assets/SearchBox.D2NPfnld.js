import{v as C,T as B}from"./runtime-dom.esm-bundler.swPJB9Bd.js";/* empty css                        */import{_ as I}from"./_plugin-vue_export-helper.DlAUqK2U.js";import{c as a,a as r,k as M,b as F,w as Q,d as S,o as j,r as n,f as o,t as m,F as _,h as k,j as H}from"./runtime-core.esm-bundler.mKm2q0Bp.js";const V=S({__name:"SearchBox",props:{placeholder:{},searchLabel:{},noResultsText:{}},setup(x,{expose:c}){c();const y=x,e=n(""),d=n([]),u=n(!1),s=n([]),l=n(!1),h=n(!1),p=async()=>{if(!(h.value||l.value)){l.value=!0;try{const t=await fetch("/search-index.json");t.ok&&(s.value=await t.json(),h.value=!0)}catch(t){console.error("Failed to load search index:",t)}finally{l.value=!1}}},b=async()=>{if(h.value||await p(),e.value.length===0){d.value=[];return}const t=e.value.toLowerCase();d.value=s.value.filter(i=>i.title.toLowerCase().includes(t)||i.description.toLowerCase().includes(t)||i.content.toLowerCase().includes(t)||i.tags.some(v=>v.toLowerCase().includes(t))).slice(0,8)},w=async()=>{u.value=!0,h.value||await p()},L=()=>{setTimeout(()=>{u.value=!1},200)},R=()=>{u.value=!1,e.value="",d.value=[]},T=t=>{if(!e.value||!t)return t||"";try{const i=e.value.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),v=new RegExp(`(${i})`,"gi");return t.replace(v,'<mark class="bg-yellow-200 dark:bg-yellow-800 px-1 rounded">$1</mark>')}catch{return t}},f=n(null);j(()=>{document.addEventListener("keydown",t=>{(t.ctrlKey||t.metaKey)&&t.key==="k"&&(t.preventDefault(),f.value&&f.value.focus())})});const g={props:y,searchQuery:e,searchResults:d,showResults:u,searchIndex:s,isLoading:l,isLoaded:h,loadSearchIndex:p,handleInput:b,handleFocus:w,handleBlur:L,handleResultClick:R,highlightText:T,searchInputRef:f};return Object.defineProperty(g,"__isScriptSetup",{enumerable:!1,value:!0}),g}}),D={class:"relative"},E={class:"relative"},N=["placeholder"],z={key:0,class:"absolute top-full left-0 right-0 mt-2 bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg shadow-lg z-50 max-h-96 overflow-y-auto"},K={key:0,class:"p-4 text-center text-slate-500 dark:text-slate-400"},q={key:1,class:"py-2"},O=["href"],P=["innerHTML"],U=["innerHTML"],A={class:"flex flex-wrap gap-1 mt-2"};function G(x,c,y,e,d,u){return o(),a("div",D,[r("div",E,[M(r("input",{ref:"searchInputRef","onUpdate:modelValue":c[0]||(c[0]=s=>e.searchQuery=s),onInput:e.handleInput,onFocus:e.handleFocus,onBlur:e.handleBlur,type:"text",placeholder:e.props.placeholder||"搜索文章...",class:"w-64 pl-10 pr-4 py-2 text-sm bg-slate-100 dark:bg-slate-800 border border-slate-300 dark:border-slate-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-colors"},null,40,N),[[C,e.searchQuery]]),c[1]||(c[1]=r("div",{class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},[r("svg",{class:"w-4 h-4 text-slate-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1))]),F(B,{name:"fade"},{default:Q(()=>[e.showResults&&(e.searchResults.length>0||e.searchQuery.length>0)?(o(),a("div",z,[e.searchResults.length===0&&e.searchQuery.length>0?(o(),a("div",K,m(e.props.noResultsText||"没有找到相关文章"),1)):(o(),a("div",q,[(o(!0),a(_,null,k(e.searchResults,s=>(o(),a("a",{key:s.url,href:s.url,class:"block px-4 py-3 hover:bg-slate-50 dark:hover:bg-slate-700 transition-colors border-b border-slate-100 dark:border-slate-700 last:border-b-0",onClick:e.handleResultClick},[r("h4",{class:"text-sm font-medium text-slate-900 dark:text-slate-100 mb-1",innerHTML:e.highlightText(s.title)},null,8,P),r("p",{class:"text-xs text-slate-600 dark:text-slate-400 line-clamp-2",innerHTML:e.highlightText(s.description)},null,8,U),r("div",A,[(o(!0),a(_,null,k(s.tags.slice(0,3),l=>(o(),a("span",{key:l,class:"text-xs px-2 py-1 bg-primary-100 dark:bg-primary-900/30 text-primary-700 dark:text-primary-300 rounded-full"},m(l),1))),128))])],8,O))),128))]))])):H("",!0)]),_:1})])}const Z=I(V,[["render",G],["__scopeId","data-v-8987e23c"]]);export{Z as default};
