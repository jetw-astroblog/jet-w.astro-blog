import{v as F,T as Q}from"./runtime-dom.esm-bundler.ByeeO9O7.js";/* empty css                        */import{_ as j}from"./_plugin-vue_export-helper.DlAUqK2U.js";import{c as a,a as o,k as E,b as H,w as V,d as D,o as N,r as c,f as r,t as w,F as L,h as C,j as q}from"./runtime-core.esm-bundler.CBw-J_OP.js";const z=D({__name:"SearchBox",props:{placeholder:{},searchLabel:{},noResultsText:{}},setup(m,{expose:i}){i();const y=m,t=c(""),d=c([]),u=c(!1),s=c([]),l=c(!1),h=c(!1),x=async()=>{if(!(h.value||l.value)){l.value=!0;try{const e=await fetch("/search-index.json");e.ok&&(s.value=await e.json(),h.value=!0)}catch(e){console.error("Failed to load search index:",e)}finally{l.value=!1}}},R=async()=>{if(h.value||await x(),t.value.length===0){d.value=[];return}const e=t.value.toLowerCase();d.value=s.value.filter(n=>n.title.toLowerCase().includes(e)||n.description.toLowerCase().includes(e)||n.content.toLowerCase().includes(e)||n.tags.some(f=>f.toLowerCase().includes(e))).slice(0,8)},T=async()=>{u.value=!0,h.value||await x()},M=()=>{setTimeout(()=>{u.value=!1},200)},B=()=>{u.value=!1,t.value="",d.value=[]},I=e=>{const n=t.value.toLowerCase();if(e.title.toLowerCase().includes(n)||e.description.toLowerCase().includes(n))return e.description||e.content.substring(0,150);if(e.content){const v=e.content.toLowerCase().indexOf(n);if(v!==-1){const _=Math.max(0,v-50),k=Math.min(e.content.length,v+n.length+100);let p=e.content.substring(_,k);return _>0&&(p="..."+p),k<e.content.length&&(p=p+"..."),p}}return e.description||e.content.substring(0,150)},S=e=>{if(!t.value||!e)return e||"";try{const n=t.value.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),f=new RegExp(`(${n})`,"gi");return e.replace(f,'<mark class="bg-yellow-200 dark:bg-yellow-800 px-1 rounded">$1</mark>')}catch{return e}},g=c(null);N(()=>{document.addEventListener("keydown",e=>{(e.ctrlKey||e.metaKey)&&e.key==="k"&&(e.preventDefault(),g.value&&g.value.focus())})});const b={props:y,searchQuery:t,searchResults:d,showResults:u,searchIndex:s,isLoading:l,isLoaded:h,loadSearchIndex:x,handleInput:R,handleFocus:T,handleBlur:M,handleResultClick:B,getMatchedContent:I,highlightText:S,searchInputRef:g};return Object.defineProperty(b,"__isScriptSetup",{enumerable:!1,value:!0}),b}}),K={class:"relative"},O={class:"relative"},P=["placeholder"],U={key:0,class:"absolute top-full left-0 right-0 mt-2 bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg shadow-lg z-50 max-h-96 overflow-y-auto"},A={key:0,class:"p-4 text-center text-slate-500 dark:text-slate-400"},G={key:1,class:"py-2"},J=["href"],W=["innerHTML"],X=["innerHTML"],Y={class:"flex flex-wrap gap-1 mt-2"};function Z(m,i,y,t,d,u){return r(),a("div",K,[o("div",O,[E(o("input",{ref:"searchInputRef","onUpdate:modelValue":i[0]||(i[0]=s=>t.searchQuery=s),onInput:t.handleInput,onFocus:t.handleFocus,onBlur:t.handleBlur,type:"text",placeholder:t.props.placeholder||"搜索文章...",class:"w-64 pl-10 pr-4 py-2 text-sm bg-slate-100 dark:bg-slate-800 border border-slate-300 dark:border-slate-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-colors"},null,40,P),[[F,t.searchQuery]]),i[1]||(i[1]=o("div",{class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},[o("svg",{class:"w-4 h-4 text-slate-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1))]),H(Q,{name:"fade"},{default:V(()=>[t.showResults&&(t.searchResults.length>0||t.searchQuery.length>0)?(r(),a("div",U,[t.searchResults.length===0&&t.searchQuery.length>0?(r(),a("div",A,w(t.props.noResultsText||"没有找到相关文章"),1)):(r(),a("div",G,[(r(!0),a(L,null,C(t.searchResults,s=>(r(),a("a",{key:s.url,href:s.url,class:"block px-4 py-3 hover:bg-slate-50 dark:hover:bg-slate-700 transition-colors border-b border-slate-100 dark:border-slate-700 last:border-b-0",onClick:t.handleResultClick},[o("h4",{class:"text-sm font-medium text-slate-900 dark:text-slate-100 mb-1",innerHTML:t.highlightText(s.title)},null,8,W),o("p",{class:"text-xs text-slate-600 dark:text-slate-400 line-clamp-2",innerHTML:t.highlightText(t.getMatchedContent(s))},null,8,X),o("div",Y,[(r(!0),a(L,null,C(s.tags.slice(0,3),l=>(r(),a("span",{key:l,class:"text-xs px-2 py-1 bg-primary-100 dark:bg-primary-900/30 text-primary-700 dark:text-primary-300 rounded-full"},w(l),1))),128))])],8,J))),128))]))])):q("",!0)]),_:1})])}const ne=j(z,[["render",Z],["__scopeId","data-v-b5bd49cb"]]);export{ne as default};
